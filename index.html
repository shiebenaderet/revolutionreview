<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Revolutionary War Study Tool</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>
    <!-- Note-Taking Reminder Modal -->
    <div id="noteModal" class="note-modal-overlay">
        <div class="note-modal">
            <div class="note-modal-icon" id="noteModalIcon">üìù</div>
            <h2 id="noteModalTitle">Update Your Notes!</h2>
            <p id="noteModalMessage">Take a moment to write this down in your notebook. This will help you remember it better!</p>

            <!-- Science explanation -->
            <div style="margin: 15px 0; padding: 12px; background: #f0f9ff; border-radius: 8px; border-left: 4px solid #0284c7; text-align: left; font-size: 0.9em;">
                <details style="cursor: pointer;">
                    <summary style="font-weight: 600; color: #0369a1; font-size: 0.95em; user-select: none;">
                        <i class="fas fa-brain"></i> Why write by hand? (The science)
                    </summary>
                    <div style="margin-top: 10px; color: #555; font-size: 0.95em; line-height: 1.5;">
                        <p style="margin-bottom: 8px;">
                            <strong>Your brain works differently when you write by hand!</strong> Scientists found:
                        </p>
                        <ul style="margin-left: 20px; margin-bottom: 8px;">
                            <li style="margin: 6px 0;"><strong>More brain connections:</strong> Handwriting activates areas for movement, vision, and memory. Typing uses minimal brain activity.</li>
                            <li style="margin: 6px 0;"><strong>Better memory:</strong> Forming each letter creates a feedback loop that helps you remember longer.</li>
                            <li style="margin: 6px 0;"><strong>Deeper understanding:</strong> Writing forces you to process information actively.</li>
                        </ul>
                        <p style="font-size: 0.85em; color: #666; margin-top: 8px;">
                            <em>Source: Scientific American</em>
                        </p>
                    </div>
                </details>
            </div>

            <button class="note-modal-btn" onclick="closeNoteModal()">
                <i class="fas fa-check"></i> I Will Update My Notes Before Moving On
            </button>
        </div>
    </div>

    <!-- Study Timer (shows on all pages except home) -->
    <div id="studyTimer" class="study-timer" style="display: none;">
        <h4><i class="fas fa-clock"></i> Study Session</h4>
        <div class="time-display" id="timerDisplay">00:00</div>
        <div class="total-time" id="totalTime">Total: 0h 0m</div>
        <div class="timer-controls">
            <button class="timer-btn pause" id="pauseBtn" onclick="toggleTimer()"><i class="fas fa-pause"></i> Pause</button>
        </div>
    </div>

    <div class="container">
        <header>
            <h1><i class="fas fa-flag-usa"></i> Revolutionary War Study Tool</h1>
            <p>Get ready to ace your test! Learn vocabulary, practice questions, and track your progress.</p>
        </header>

        <div class="content">
            <!-- Tooltip for definitions -->
            <div id="definitionTooltip" class="tooltip">
                <span class="close-tooltip" onclick="closeTooltip()">‚úï</span>
                <div id="tooltipContent"></div>
            </div>

            <!-- HOME SECTION -->
            <div id="home" class="section active">
                <h2 style="margin-bottom: 20px;">Pick How You Want to Study</h2>

                <div id="overallProgress"></div>

                <div class="nav-buttons">
                    <button class="nav-btn" onclick="showSection('vocab')">
                        <i class="fas fa-book"></i> Learn Vocabulary<br>
                        <small>Flip through flashcards (22 terms)</small>
                    </button>
                    <button class="nav-btn secondary" onclick="showSection('practice')">
                        <i class="fas fa-dumbbell"></i> Practice Mode<br>
                        <small>Get hints when you're wrong!</small>
                    </button>
                    <button class="nav-btn" onclick="showSection('timeline')" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <i class="fas fa-clock"></i> Timeline Challenge<br>
                        <small>Put events in chronological order (10 events)</small>
                    </button>
                    <button class="nav-btn success" onclick="showSection('shortanswer')">
                        <i class="fas fa-pencil-alt"></i> Short Answer Practice<br>
                        <small>Practice writing responses</small>
                    </button>
                    <button class="nav-btn success" onclick="showSection('test')">
                        <i class="fas fa-check-circle"></i> Take a Practice Test<br>
                        <small>See if you're ready (30 questions)</small>
                    </button>
                    <button class="nav-btn" onclick="showSection('progress')">
                        <i class="fas fa-chart-line"></i> Check My Progress<br>
                        <small>What do I know? What do I need to work on?</small>
                    </button>
                    <button class="nav-btn" onclick="showSection('analytics')" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-chart-bar"></i> Analytics Dashboard<br>
                        <small>Study patterns & question difficulty insights</small>
                    </button>
                    <button class="nav-btn" onclick="showSection('printguide')" style="background: linear-gradient(135deg, #FA8BFF 0%, #2BD2FF 100%);">
                        <i class="fas fa-print"></i> Print Study Guide<br>
                        <small>Get a printable reference sheet</small>
                    </button>
                    <button class="nav-btn" onclick="showSection('focused')" style="background: linear-gradient(135deg, #FA709A 0%, #FEE140 100%);">
                        <i class="fas fa-brain"></i> Focused Study Mode<br>
                        <small>AI-powered practice for weak areas</small>
                    </button>
                    <button class="nav-btn" onclick="showSection('saveload')" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-save"></i> Save & Load Progress<br>
                        <small>Backup your work or transfer to another device</small>
                    </button>
                </div>

                <div class="alert info">
                    <i class="fas fa-lightbulb"></i>
                    <div>
                        <strong>How to Study:</strong> Start with vocabulary flashcards to learn the words. Then do practice questions to test yourself. When you feel confident, take the full practice test!
                    </div>
                </div>
            </div>

            <!-- VOCABULARY SECTION -->
            <div id="vocab" class="section">
                <button class="btn btn-secondary" onclick="showSection('home')">‚Üê Back to Home</button>

                <h2 style="margin: 20px 0;">Vocabulary Flashcards</h2>

                <div class="progress-bar">
                    <div class="progress-fill" id="vocabProgressBar" style="width: 0%"></div>
                    <div class="progress-text" id="vocabProgress">0/22 terms mastered (0%)</div>
                </div>

                <div id="flashcardContainer"></div>

                <div class="card-controls">
                    <button class="btn btn-secondary" onclick="prevCard()"><i class="fas fa-arrow-left"></i> Previous</button>
                    <button class="btn btn-primary" onclick="markKnown()"><i class="fas fa-check"></i> I Know This</button>
                    <button class="btn btn-secondary" onclick="nextCard()">Next <i class="fas fa-arrow-right"></i></button>
                </div>

                <p class="flip-indicator">Click the card to flip between term and definition</p>

                <div class="keyboard-hint">
                    <span><span class="key">‚Üê</span> <span class="key">‚Üí</span> Navigate cards</span>
                    <span><span class="key">Space</span> Flip card</span>
                    <span><span class="key">K</span> Mark known</span>
                    <span><span class="key">Esc</span> Home</span>
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="shuffleCards()"><i class="fas fa-random"></i> Shuffle Cards</button>
                    <button class="reset-btn" onclick="resetVocabProgress()">Reset Vocabulary Progress</button>
                </div>
            </div>

            <!-- PRACTICE SECTION -->
            <div id="practice" class="section">
                <button class="btn btn-secondary" onclick="showSection('home')">‚Üê Back to Home</button>

                <h2 style="margin: 20px 0;">Practice Questions</h2>

                <div class="alert info">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <strong>Practice Mode:</strong> Answer each question, then click "Check Answer" to see if you're right. If you get it wrong, you'll see an explanation to help you learn! <em>Click on any <span class="vocab-term">highlighted words</span> to see their definition.</em>
                    </div>
                </div>

                <div class="keyboard-hint">
                    <span><span class="key">1</span> <span class="key">2</span> <span class="key">3</span> <span class="key">4</span> Select answer</span>
                    <span><span class="key">Esc</span> Home</span>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="practiceProgressBar" style="width: 0%"></div>
                    <div class="progress-text" id="practiceProgress">Question 0 of 0</div>
                </div>

                <div id="practiceContainer"></div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="loadNewPracticeSet()"><i class="fas fa-sync-alt"></i> New Practice Set</button>
                </div>
            </div>

            <!-- SHORT ANSWER SECTION -->
            <div id="shortanswer" class="section">
                <button class="btn btn-secondary" onclick="showSection('home')"><i class="fas fa-arrow-left"></i> Back to Home</button>

                <h2 style="margin: 20px 0;">Short Answer Practice</h2>

                <div class="alert info">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <strong>Practice Mode:</strong> Write your answer in the box, then reveal an example answer and self-assessment checklist. Compare your answer to see how you did!
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="shortAnswerProgressBar" style="width: 0%"></div>
                    <div class="progress-text" id="shortAnswerProgress">Question 0 of 5</div>
                </div>

                <div id="shortAnswerContainer"></div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="loadShortAnswers()"><i class="fas fa-sync-alt"></i> Start Over</button>
                </div>
            </div>

            <!-- TEST SECTION -->
            <div id="test" class="section">
                <button class="btn btn-secondary" onclick="showSection('home')">‚Üê Back to Home</button>

                <h2 style="margin: 20px 0;">Practice Test</h2>

                <div class="alert info">
                    <i class="fas fa-bolt"></i>
                    <div>
                        <strong>Test Mode:</strong> Answer all 30 questions, then see your results. No peeking at answers until the end!
                    </div>
                </div>

                <div class="keyboard-hint">
                    <span><span class="key">1</span> <span class="key">2</span> <span class="key">3</span> <span class="key">4</span> Select answer for question in view</span>
                    <span><span class="key">Esc</span> Home</span>
                </div>

                <div id="testContainer"></div>
            </div>

            <!-- PROGRESS SECTION -->
            <div id="progress" class="section">
                <button class="btn btn-secondary" onclick="showSection('home')">‚Üê Back to Home</button>

                <h2 style="margin: 20px 0;">Your Progress</h2>

                <div class="stats-grid" id="statsContainer"></div>

                <div id="weaknessContainer"></div>
                <div id="strengthContainer"></div>

                <div style="margin: 30px 0; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                    <h3 style="margin-bottom: 15px;"><i class="fas fa-save"></i> Save & Load</h3>
                    <p style="margin-bottom: 15px; color: #666;">Save your progress to a file, or load previously saved progress:</p>
                    <button class="btn btn-primary" onclick="exportProgress()"><i class="fas fa-download"></i> Save My Progress</button>
                    <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()"><i class="fas fa-upload"></i> Load Saved Progress</button>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importProgress(event)">
                </div>

                <button class="reset-btn" onclick="resetAllProgress()">Reset All Progress</button>
            </div>

            <!-- ANALYTICS DASHBOARD SECTION -->
            <div id="analytics" class="section">
                <button class="btn btn-secondary" onclick="showSection('home')">‚Üê Back to Home</button>

                <h2 style="margin: 20px 0;"><i class="fas fa-chart-bar"></i> Analytics Dashboard</h2>

                <div class="alert info">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <strong>Data-Driven Insights:</strong> This dashboard shows your study patterns, question difficulty analysis, and performance metrics to help you study smarter!
                    </div>
                </div>

                <div id="analyticsContent">
                    <!-- Analytics content will be dynamically loaded here -->
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn btn-secondary" onclick="loadAnalyticsDashboard()">
                        <i class="fas fa-sync-alt"></i> Refresh Analytics
                    </button>
                </div>
            </div>

            <!-- PRINT STUDY GUIDE SECTION -->
            <div id="printguide" class="section">
                <button class="btn btn-secondary" onclick="showSection('home')">‚Üê Back to Home</button>

                <h2 style="margin: 20px 0;">Print Study Guide</h2>

                <div class="alert info">
                    <i class="fas fa-print"></i>
                    <div>
                        <strong>Print This Guide:</strong> Click the "Print Study Guide" button below to generate a printer-friendly version. You can also filter by category to print only what you need!
                    </div>
                </div>

                <div style="margin: 20px 0;">
                    <label style="font-weight: 600; margin-right: 10px;">Filter by category:</label>
                    <select id="printCategory" onchange="updatePrintGuide()" style="padding: 8px 15px; border-radius: 8px; border: 2px solid #e0e0e0; font-size: 1em;">
                        <option value="all">All Categories</option>
                        <option value="Causes of Unrest">Causes of Unrest</option>
                        <option value="Uncovering Loyalties">Uncovering Loyalties</option>
                        <option value="Declaration">Declaration</option>
                    </select>
                </div>

                <div style="text-align: center; margin: 20px 0;">
                    <button class="btn btn-primary" onclick="window.print()"><i class="fas fa-print"></i> Print Study Guide</button>
                    <button class="btn btn-secondary" onclick="markAllForPrint()"><i class="fas fa-check-square"></i> Select All for Study</button>
                    <button class="btn btn-secondary" onclick="markUnknownForPrint()"><i class="fas fa-exclamation-triangle"></i> Select Unknown Terms</button>
                </div>

                <div id="printGuideContent" style="margin-top: 30px;"></div>
            </div>

            <!-- FOCUSED STUDY MODE SECTION -->
            <div id="focused" class="section">
                <button class="btn btn-secondary" onclick="showSection('home')">‚Üê Back to Home</button>

                <h2 style="margin: 20px 0;">Focused Study Mode</h2>

                <div class="alert info">
                    <i class="fas fa-brain"></i>
                    <div>
                        <strong>Smart Practice:</strong> This mode analyzes your performance and creates a personalized study session focusing on your weak areas. It includes vocabulary you haven't mastered and topics where you've struggled.
                    </div>
                </div>

                <div id="focusedAnalysis"></div>

                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn btn-primary" onclick="startFocusedSession()" style="font-size: 1.2em; padding: 15px 40px;">
                        <i class="fas fa-play"></i> Start Focused Session
                    </button>
                </div>

                <div id="focusedContent"></div>
            </div>

            <!-- SAVE & LOAD SECTION -->
            <div id="saveload" class="section">
                <button class="btn btn-secondary" onclick="showSection('home')">‚Üê Back to Home</button>

                <h2 style="margin: 20px 0;"><i class="fas fa-save"></i> Save & Load Progress</h2>

                <div class="alert info">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <strong>Why save your progress?</strong> Save your work to a file so you can:
                        <ul style="margin: 10px 0 0 20px;">
                            <li>Keep your progress safe if you clear your browser</li>
                            <li>Continue studying on a different computer or device</li>
                            <li>Share your progress with your teacher</li>
                        </ul>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 30px 0;">
                    <div style="padding: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; color: white; text-align: center;">
                        <i class="fas fa-download" style="font-size: 3em; margin-bottom: 15px;"></i>
                        <h3 style="margin-bottom: 15px;">Save My Progress</h3>
                        <p style="margin-bottom: 20px; opacity: 0.9;">Download a file with all your progress - vocabulary, practice scores, test results, and badges.</p>
                        <button class="btn btn-primary" onclick="exportProgress()" style="background: white; color: #667eea; font-size: 1.1em; padding: 12px 30px;">
                            <i class="fas fa-download"></i> Save Now
                        </button>
                    </div>

                    <div style="padding: 30px; background: linear-gradient(135deg, #764ba2 0%, #667eea 100%); border-radius: 15px; color: white; text-align: center;">
                        <i class="fas fa-upload" style="font-size: 3em; margin-bottom: 15px;"></i>
                        <h3 style="margin-bottom: 15px;">Load Saved Progress</h3>
                        <p style="margin-bottom: 20px; opacity: 0.9;">Upload a previously saved file to restore your progress from another session or device.</p>
                        <button class="btn btn-secondary" onclick="document.getElementById('importFileMain').click()" style="background: white; color: #764ba2; font-size: 1.1em; padding: 12px 30px;">
                            <i class="fas fa-upload"></i> Load File
                        </button>
                        <input type="file" id="importFileMain" accept=".json" style="display: none;" onchange="importProgress(event)">
                    </div>
                </div>

                <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 10px; border-left: 4px solid #ffc107;">
                    <h4 style="color: #856404; margin-bottom: 10px;"><i class="fas fa-exclamation-triangle"></i> Important Tips:</h4>
                    <ul style="margin: 10px 0 0 20px; color: #856404;">
                        <li>Save your progress regularly, especially before closing your browser</li>
                        <li>Keep the downloaded file in a safe place (like Google Drive or USB drive)</li>
                        <li>Loading a file will replace your current progress</li>
                        <li>The file is small and safe to email or share</li>
                    </ul>
                </div>
            </div>

            <!-- TIMELINE CHALLENGE SECTION -->
            <div id="timeline" class="section">
                <button class="btn btn-secondary" onclick="showSection('home')">‚Üê Back to Home</button>

                <h2 style="margin: 20px 0;"><i class="fas fa-clock"></i> Timeline Challenge</h2>

                <div class="alert info">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <strong>Timeline Challenge:</strong> Arrange the 10 key events leading to and including the Revolutionary War in chronological order! Understanding the sequence helps you see how tensions escalated over time.
                    </div>
                </div>

                <div class="timeline-mode-toggle">
                    <button class="mode-btn active" id="easyModeBtn" onclick="setTimelineMode('easy')">
                        <i class="fas fa-lightbulb"></i> Show Years (default)
                    </button>
                    <button class="mode-btn" id="challengeModeBtn" onclick="setTimelineMode('challenge')">
                        <i class="fas fa-medal"></i> Challenge Mode
                    </button>
                </div>

                <div class="keyboard-hint">
                    <span><span class="key">Click & Drag</span> Move events</span>
                    <span><span class="key">R</span> Restart</span>
                    <span><span class="key">Esc</span> Home</span>
                </div>

                <div id="timelineStats" style="text-align: center; margin: 20px 0; display: none;">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; display: inline-block;">
                        <strong>Best Score:</strong> <span id="timelineBestScore">0</span>/10 |
                        <strong>Perfect Scores:</strong> <span id="timelinePerfectCount">0</span>/3 |
                        <strong>Attempts:</strong> <span id="timelineAttempts">0</span>
                    </div>
                </div>

                <div class="timeline-container" id="timelineContainer">
                    <div class="timeline-events">
                        <h3 style="margin-bottom: 20px; color: #667eea;">
                            <i class="fas fa-list"></i> Events to Arrange
                        </h3>
                        <div id="timelineEventsList"></div>
                    </div>

                    <div class="timeline-slots">
                        <h3 style="margin-bottom: 20px; color: #667eea;">
                            <i class="fas fa-sort-numeric-up"></i> Timeline (Drag events here)
                        </h3>
                        <div id="timelineSlotsList"></div>
                    </div>
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn btn-primary" onclick="checkTimelineAnswer()" id="checkTimelineBtn" style="font-size: 1.1em; padding: 12px 30px;">
                        <i class="fas fa-check-circle"></i> Check My Answer
                    </button>
                    <button class="btn btn-secondary" onclick="resetTimeline()" style="font-size: 1.1em; padding: 12px 30px;">
                        <i class="fas fa-redo"></i> Try Again
                    </button>
                    <button class="btn btn-secondary" onclick="showTimelineAnswer()" style="font-size: 1.1em; padding: 12px 30px;">
                        <i class="fas fa-eye"></i> Show Answer
                    </button>
                </div>

                <div id="timelineResults"></div>
            </div>
        </div>
    </div>

    <script type="module" src="src/js/app.js"></script>
</body>
</html>
